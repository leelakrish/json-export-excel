/*! json-export-excel 20-07-2017 */
!function(){"use strict";angular.module("ngJsonExportExcel",[]).directive("ngJsonExportExcel",function(){return{restrict:"AE",scope:{data:"=",filename:"=?",reportFields:"=",separator:"@"},link:function(a,b){function c(){angular.forEach(a.reportFields,function(a,b){if(!a||!b)throw new Error("error json report fields");g.push(b),h.push(a)})}function d(){var b=a.data,c="";return angular.forEach(b,function(a){var d=[];angular.forEach(g,function(c){if(c.indexOf(".")){c=c.split(".");var e=a;angular.forEach(c,function(a){null!==e&&void 0!==e&&(e=e[a])}),b=e}else b=a[c];var g=null!==b?b:" ";void 0!==g&&angular.isObject(g)&&(g=f(g)),"string"==typeof g?d.push('"'+g.replace(/"/g,'""')+'"'):d.push(g)}),c+=d.join(i)+"\n"}),c}function e(a){return h.join(i)+"\n"+a}function f(a){var b="";return angular.forEach(a,function(a,c){b+=c+":"+a+" "}),'"'+b+'"'}a.filename=a.filename?a.filename:"export-excel";var g=[],h=[],i=a.separator||";";b.bind("click",function(){var b=(c(),d()),f=e(b),g=new Blob([f],{type:"text/plain;charset=utf-8"});return saveAs(g,[a.filename+".csv"])})}}})}();